version: '3.8'

services:
  waha:
    image: devlikeapro/waha:latest
    container_name: waha-test
    restart: unless-stopped
    ports:
      - "3001:3000"
    environment:
      # Webhook aponta para o backend local (fora do Docker)
      - WHATSAPP_HOOK_URL=http://host.docker.internal:8080/api/webhooks/waha
      - WHATSAPP_HOOK_EVENTS=message,message.any
      - WHATSAPP_HOOK_HEADERS={"X-Webhook-Token":"wh_8F3kL9mN2pQ7rT1vY4xZ6aB0cD5eG8hJ"}
      - WAHA_PRINT_QR=True
      - WAHA_LOG_LEVEL=info
      - WHATSAPP_SWAGGER_ENABLED=true
      - WHATSAPP_SWAGGER_USERNAME=admin
      - WHATSAPP_SWAGGER_PASSWORD=admin
    volumes:
      - waha_test_data:/app/.wwebjs_auth
      - waha_test_files:/app/.wwebjs_cache

volumes:
  waha_test_data:
    driver: local
  waha_test_files:
    driver: local

